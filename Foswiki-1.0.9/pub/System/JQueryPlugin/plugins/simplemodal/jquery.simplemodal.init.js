(function(b){function a(f,d){b.log("SM: called openDialog data="+f);var e=b(f);e.modal(d);b(".jqSimpleModalOK",e).click(function(g){b.log("SM: clicked ok");b.modal.close();if(typeof(d.onSubmit)=="function"){d.onSubmit(e)}g.preventDefault();return false});b(".jqSimpleModalCancel",e).click(function(g){b.log("SM: clicked cancel");b.modal.close();if(typeof(d.onCancel)=="function"){d.onCancel(e)}g.preventDefault();return false})}var c={persist:true,close:false,onShow:function(){b(window).trigger("resize.simplemodal")}};b(function(){b(".jqSimpleModal:not(.jqInitedSimpleModal)").livequery(function(){var d=b(this);d.addClass("jqInitedSimpleModal").click(function(g){var f=b.extend({},c,d.metadata());var h=d.attr("simple-modal-data")||f.data;if(f.url&&!h){b.get(f.url,function(i){var e=b(i);h=e.attr("id");if(!h){h=foswiki.getUniqueID();e.attr("id",h).hide();b("body").append(e)}d.attr("simple-modal-data","#"+h);a("#"+h,f)})}else{a(h,f)}g.preventDefault();return false})})})})(jQuery);