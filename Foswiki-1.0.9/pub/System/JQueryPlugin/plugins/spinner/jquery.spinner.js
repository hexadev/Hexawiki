(function(b){function a(c){if(b.log){b.log(c)}}b.fn.spinner=function(c){var d=b.extend({},b.fn.spinner.defaults,c);return this.each(function(){$this=b(this);if(typeof c=="string"){if(c=="stop"){var e=b.data(this,"spinner");if(e.intervalId){a("stop "+this.id);clearInterval(e.intervalId);e.intervalId=undefined;b.data(this,"spinner",e)}return}else{if(c=="redraw"){var e=b.data(this,"spinner");a("redraw "+this.id);a(e);if(e.frame>=e.frames){e.frame=1}pos="-"+(e.frame*e.width)+"px 0px";$this.css("background-position",pos);e.frame=e.frame+1;b.data(this,"spinner",e);return}}}var e=b.extend({},d,b.data(this,"spinner"));a("dump "+this.id);a(e);if(e.intervalId){$this.spinner("stop")}if(e.height){$this.height(e.height)}if(e.width){$this.width(e.width)}$this.css("background-image","url("+e.image+")");$this.css("background-position","0px 0px");$this.css("background-repeat","no-repeat");img=new Image();img.src=e.image;img.onload=function(){a("image.onload "+this.id);e.frames=img.width/e.width;a(e);b.data(this,"spinner",e)};if(!e.speed){e.speed=25}a("start "+this.id);e.frame=0;e.intervalId=setInterval("$('#"+this.id+"').spinner('redraw')",e.speed);b.data(this,"spinner",e)})};b.fn.spinner.defaults={height:32,width:32,speed:50,frame:0,frames:31,intervalId:0}})(jQuery);