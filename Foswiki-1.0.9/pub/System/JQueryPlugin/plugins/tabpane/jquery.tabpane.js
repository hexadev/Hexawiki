var bottomBarHeight=-1;(function(a){a.tabpane={build:function(b){if(typeof(b)=="undefined"){b={}}var c=a.extend({},a.tabpane.defaults,b);return this.each(function(){var h=a(this);var g=a.extend({},c,h.metadata());if(a.browser.msie){g.animate=false}if(!h.is(".jqTabPaneInitialized")){h.addClass("jqTabPaneInitialized");a("<span class='foswikiClear'></span>").prependTo(h);var d=h;var f=a('<ul class="jqTabGroup"></ul>').prependTo(h);var e=1;h.find("> .jqTab").each(function(){var i=a(this);var j=i.find("h2:first").remove().text();f.append('<li><a href="#" data="'+this.id+'">'+j+"</a></li>");if(e==g.select||i.hasClass(g.select)){g.currentTabId=this.id}e++});if(g.currentTabId){a.tabpane.switchTab(h,g,g.currentTabId)}if(g.autoMaxExpand){a.tabpane.autoMaxExpand(h,g)}h.find(".jqTabGroup > li > a").click(function(){a(this).blur();var i=a(this).attr("data");if(i!=g.currentTabId){a.tabpane.switchTab(h,g,i)}return false})}})},switchTab:function(l,b,i){var f=b.currentTabId;var j=jQuery("#"+i);var g=jQuery("#"+f);var d=j.find(".jqTabContents");var e=g.find(".jqTabContents");var k=e.height();g.removeClass("current");j.addClass("current");l.find("li a[data="+f+"]").parent().removeClass("current");l.find("li a[data="+i+"]").parent().addClass("current");if(!b[i]){b[i]=j.metadata()}var h=b[i];if(typeof(h.beforeHandler)=="function"){h.beforeHandler.call(this,f,i)}if((b.animate||b.autoMaxExpand)&&k>0){d.height(k)}function c(){var n="none";if(k>0){n="easeInOutQuad"}if(b.autoMaxExpand){if(b.animate&&n!="none"){d.css({opacity:0}).animate({opacity:1},300)}a(window).trigger("resize")}else{if(b.animate){d.height("auto");var m=d.height();if(n!="none"){d.height(k).css({opacity:0}).animate({opacity:1,height:m},300,n,function(){d.height("auto")})}else{d.height("auto")}}}if(typeof(h.afterHandler)=="function"){h.afterHandler.call(this,f,i)}b.currentTabId=i}if(typeof(h.url)!="undefined"){d.load(h.url,undefined,function(){if(typeof(h.afterLoadHandler)=="function"){h.afterLoadHandler.call(this,f,i)}c()});delete b[i].url}else{c()}},autoMaxExpand:function(c,b){window.setTimeout(function(){jQuery.tabpane.fixHeight(c,b);jQuery(window).one("resize",function(){a.tabpane.autoMaxExpand(c,b)})},100)},fixHeight:function(e,d){var f=e.find("> .jqTab.current .jqTabContents");var c=f.offset();if(typeof(c)=="undefined"){return}var i=c.top;if(bottomBarHeight<=0){bottomBarHeight=jQuery(".natEditBottomBar").outerHeight(true)}var h=jQuery(window).height();if(!h){h=window.innerHeight}var b=h-i-2*bottomBarHeight;var g=a("#DEBUG");if(g){b-=g.outerHeight(true)}if(d&&d.minHeight&&b<d.minHeight){b=d.minHeight}if(b<0){return}f.height(b)},defaults:{select:1,animate:false,autoMaxExpand:false,minHeight:230}};a.fn.tabpane=a.tabpane.build})(jQuery);